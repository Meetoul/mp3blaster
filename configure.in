dnl Process this file with autoconf to produce a configure script.
AC_INIT(src/main.cc)
AM_INIT_AUTOMAKE(mp3blaster, 2.0b4)

dnl CPLUS_INCLUDE_PATH=$C_INCLUDE_PATH:/usr/local/lib/qt/include

dnl Checks for programs.
AC_PROG_CC
AC_PROG_CXX
AC_PROG_INSTALL
AC_PROG_RANLIB

dnl Checks for libraries.
AC_CHECK_LIB(m,main,,AC_MSG_ERROR("No libm or no cos"))
AC_CHECK_LIB(pthread,main,INCLUDEPTHREAD=1)
AC_CHECK_LIB(ncurses,main)

dnl Checks for header files.
AC_HEADER_STDC
AC_CHECK_HEADERS(fcntl.h malloc.h sys/ioctl.h unistd.h bool.h)
AC_CHECK_HEADERS(pthread.h pthread/mit/pthread.h)
AC_CHECK_HEADERS(ncurses/ncurses.h ncurses/curses.h ncurses.h curses.h)

dnl Checks for typedefs, structures, and compiler characteristics.
AC_C_CONST
AC_C_BIGENDIAN

dnl Checks for library functions.
AC_PROG_GCC_TRADITIONAL
AC_CHECK_FUNCS(strdup strstr)

dnl check argument

dnl AC_ARG_WITH(pthread,  [ --with-pthread   playing with pthread], \
dnl   if test "$withval" = "yes"; then
dnl     INCLUDEPTHREAD=1
dnl   else
dnl     INCLUDEPTHREAD=0
dnl   fi;)

SRCDIRS="src mpegsound"
AC_SUBST(SRCDIRS)

LIBMPEGSOUND=../mpegsound/libmpegsound.a
AC_SUBST(LIBMPEGSOUND)

if test "$INCLUDEPTHREAD" = 1; then
	LIBS="$LIBS -lpthread"
AC_DEFINE(PTHREADEDMPEG)
AC_DEFINE(_REENTRANT)
fi

CXXFLAGS="$CXXFLAGS -Wall -Wstrict-prototypes -W -fno-strength-reduce "

PACKAGE=mp3blaster
VERSION=2.0b4
dnl PACKAGE_VERSION="$PACKAGE-$VERSION"
dnl AC_DEFINE_UNQUOTED(PACKAGE, "$PACKAGE")
dnl AC_DEFINE_UNQUOTED(VERSION, "$VERSION")
dnl AC_SUBST(PACKAGE)
dnl AC_SUBST(VERSION)


AC_OUTPUT(src/Makefile mpegsound/Makefile Makefile)
